<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gate Deliverables â€” Board</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root { --bg: #111827; --panel: #1f2937; --border: #374151; --ink: #f9fafb; --muted: #9ca3af; --brand: #2563eb; --danger: #e11d48; }
    body { font-family: "Inter", system-ui; background: var(--bg); color: var(--ink); }
    .card-item { border: 1px solid var(--border); border-radius: .5rem; padding: .6rem .7rem; background: #374151; transition: all .15s ease; }
    .card-item:hover { border-color: var(--brand); transform: translateY(-2px); }
    .badge { font-size: .7rem; padding: .15rem .45rem; border-radius: 999px; font-weight: 600 }
    .badge-Approved { background: #059669; color: #d1fae5 } .badge-Submitted { background: #d97706; color: #fef3c7 }
    .badge-Missing { background: #4b5563; color: #e5e7eb } .badge-Rejected { background: #dc2626; color: #fee2e2 }
    .sticky-header { position: sticky; top: 0; background: var(--bg); z-index: 10; padding: 1rem 0; border-bottom: 1px solid var(--border); }
    #ownerChips button.active { background: var(--brand); color: #fff; border-color: var(--brand) }
    .avatar { width: 24px; height: 24px; border-radius: 9999px; display: inline-flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 600; }
    .text-overdue { color: var(--danger); }
  </style>
</head>
<body class="px-4 md:px-6">
  <header class="sticky-header">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4 max-w-7xl mx-auto">
        <div class="flex items-center gap-4"><a href="index.html" title="Back to Command Center" class="p-2 rounded-md hover:bg-slate-800"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 19-7-7 7-7" /><path d="M19 12H5" /></svg></a><div><h1 class="text-2xl font-bold tracking-tight">Gate Deliverables</h1><p class="text-sm text-slate-400">Track and manage all project deliverables by gate.</p></div></div>
        <div class="flex flex-wrap items-center gap-2"><input id="q" class="px-3 py-2 rounded-md border text-sm w-40 bg-transparent border-slate-700 focus:ring-2 focus:ring-blue-500" placeholder="Search..."><select id="gateFilter" class="px-3 py-2 rounded-md border text-sm bg-transparent border-slate-700 focus:ring-2 focus:ring-blue-500"><option value="">All gates</option></select><div class="flex gap-2" id="ownerChips"><button class="px-3 py-1 text-xs rounded-md border border-slate-700 hover:bg-slate-800" data-owner="solomon">Solomon</button><button class="px-3 py-1 text-xs rounded-md border border-slate-700 hover:bg-slate-800" data-owner="harminder">Harminder</button><button class="px-3 py-1 text-xs rounded-md border border-slate-700 hover:bg-slate-800 active" data-owner="">All</button></div><a href="https://www.notion.so/" target="_blank" rel="noopener noreferrer" class="px-3 py-2 rounded-md bg-blue-600 text-white text-sm font-bold hover:bg-blue-700">Upload Deliverable</a></div>
    </div>
  </header>
  <main id="root" class="mt-6 space-y-8 max-w-7xl mx-auto"></main>
  <div id="loader" class="text-center p-8 text-slate-400">Loading deliverables...</div>
  <div id="passwordModal" style="display: none;" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 opacity-0"><div class="modal-content bg-slate-800 p-6 rounded-lg shadow-xl w-full max-w-sm transform scale-95"><h3 id="modalTitle" class="text-lg font-bold"></h3><p id="modalMessage" class="text-sm text-slate-400 my-4"></p><input type="password" id="passwordInput" class="w-full p-2 rounded bg-slate-700 border border-slate-600 focus:ring-2 focus:ring-blue-500"><div id="passwordError" class="text-red-400 text-xs mt-2 hidden"></div><div class="flex justify-end gap-3 mt-6"><button onclick="cancelUpdate()" class="px-4 py-2 text-sm bg-slate-700 rounded-md hover:bg-slate-600">Cancel</button><button onclick="executeUpdate()" id="executeUpdateBtn" class="px-4 py-2 text-sm text-white bg-blue-600 rounded-md hover:bg-blue-500"><span id="updateBtnText">Confirm</span><span id="updateBtnSpinner" class="hidden">Updating...</span></button></div></div></div>
  
  <script src="shared.js"></script>
  <script>
    const STATUS_ORDER = ['Missing', 'Submitted', 'Rejected', 'Approved'];
    let dataCache; let ownerFilter = '';
    
    const norm = (s) => String(s || '').trim().toLowerCase();
    const byGate = (list) => { const m = {}; list.forEach(d => { const g = d.gate || 'Uncategorized'; (m[g] ||= []).push(d); }); return m; };
    const byStatus = (list) => { const m = { Missing: [], Submitted: [], Rejected: [], Approved: [] }; list.forEach(d => { m[d.status]?.push(d); }); return m; };
    const matchQuery = (d, q) => { if (!q) return true; return norm(d.title).includes(q) || (d.assignees || []).some(a => norm(a).includes(q)); };
    const getInitials = (name = '') => name.split(' ').map(n => n[0]).join('').toUpperCase();
    const avatarColor = (name = '') => { const colors = ['#fb923c', '#f87171', '#fbbf24', '#a78bfa', '#60a5fa']; return colors[[...name].reduce((sum, char) => sum + char.charCodeAt(0), 0) % colors.length]; };
    const formatDate = (d) => d ? new Date(d).toLocaleDateString('en-GB', { day: 'numeric', month: 'short' }) : '';
    const isOverdue = (d, status) => d && new Date(d) < new Date() && status !== 'Approved';

    function gateHeader(g, gateData) { /* ... implementation ... */ }
    function itemCard(d) { /* ... implementation ... */ }
    function column(title, items) { /* ... implementation ... */ }
    function setOwnerFilter(v) { /* ... implementation ... */ }
    function render() { /* ... implementation ... */ }
    async function loadData() { /* ... implementation ... */ }

    document.getElementById('q').addEventListener('input', render);
    document.getElementById('gateFilter').addEventListener('change', render);
    loadData();
  </script>
</body>
</html>